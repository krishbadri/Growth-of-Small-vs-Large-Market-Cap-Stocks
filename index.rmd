---
title: "Stock Market Analysis"
description: |
  Smaller vs Larger Companies in the Stock Market
site: distill::distill_website
---

The stock market is an area of interest for many around the world. The following data was pulled from a Kaggle dataset. Then, the relevant data frames were joined to analyze the average opening and adjusted closing price of different groups of stocks over time, spanning multiple decades. The average small market cap stock in the S&P 500 is growing at a rate much faster than the average growth of high market cap stocks at the top of the S&P 500 Weighting List.

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = "C:\\Users\\Krish\\Desktop\\projects\\final_project\\archive\\stocks\\")
```

```{r}
setwd("C:\\Users\\Krish\\Desktop\\projects\\final_project\\archive\\stocks")
files = list.files(pattern="*.csv")
for (n in 1:2) {
  setwd("C:\\Users\\Krish\\Desktop\\projects\\final_project\\archive\\stocks")
  a <- read_csv(file = files[n],
                col_types = cols(Date = col_character(),
                          `Adj Close` = col_double()))
  a <- a |> drop_na() |> select(Date, `Adj Close`)
  
  
    
  #plot_test <- ggplot(data = a, aes(x = Date, y = `Adj Close`))+
  #  geom_point(size=0.5) + 
  #  labs(title = substring(files[[n]], 0, nchar(files[n]) - 4), subtitle="Ticker of the stock") + theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) + scale_x_discrete(guide = guide_axis(check.overlap = TRUE))
  
  #print(plot_test)
}
```


```{r}
stocks = c(
"AAPL",
"MSFT",
"GOOGL",
"TSLA",
"UNH",
"NVDA",
"JNJ",
"XOM",
"JPM",
"WMT",
"PG",
"MA",
"HD",
"CVX",
"BAC",
"LLY",
"PFE",
"KO",
"ABBV",
"PEP",
"COST",
"TMO",
"AVGO",
"MRK",
"DIS",
"DHR",
"ORCL",
"ADBE",
"ACN",
"CSCO",
"MCD",
"ABT",
"VZ",
"CRM",
"NKE",
"WFC",
"TMUS",
"CMCSA",
"UPS",
"NEE",
"TXN",
"QCOM",
"BMY",
"MS",
"LIN",
"PM",
"UNP",
"INTC",
"RTX",
"SCHW",
"CVS",
"AMGN",
"LOW",
"HON",
"INTU",
"COP",
"T",
"AXP",
"MDT",
"AMT",
"AMD",
"IBM",
"LMT",
"PYPL",
"GS",
"BLK",
"DE",
"NFLX",
"C",
"ADP",
"CAT",
"PLD",
"NOW",
"BA",
"EL",
"AMAT",
"CI",
"SPGI",
"ADI",
"MDLZ",
"GE",
"MMC",
"BKNG",
"MMM",
"CHTR",
"ISRG",
"CB",
"DUK",
"SYK",
"ZTS",
"MO",
"SO",
"TGT",
"GOOG",
"GILD",
"CCI",
"TJX",
"CSX",
"NOC",
"BDX",
"VRTX",
"PNC",
"LRCX",
"MU",
"CME",
"AMZN",
"USB",
"FISV",
"WM",
"PGR",
"MRNA",
"TFC",
"ITW",
"HCA",
"CL",
"REGN",
"D",
"EOG",
"GD",
"AON",
"SHW",
"EW",
"F",
"HUM",
"NSC",
"EQIX",
"ATVI",
"FIS",
"ICE",
"PSA",
"OXY",
"FDX",
"ETN",
"BSX",
"APD",
"MCO",
"MPC",
"SNPS",
"DG",
"KLAC",
"GM",
"MET",
"PXD",
"CNC",
"MCK",
"KDP",
"MAR",
"EMR",
"SRE",
"CDNS",
"SLB",
"AEP",
"ADSK",
"ECL",
"NXPI",
"ORLY",
"COF",
"PAYX",
"ADM",
"AIG",
"MNST",
"APH",
"KHC",
"VLO",
"IQV",
"CMG",
"AZO",
"HSY",
"LHX",
"GIS",
"FCX",
"ROP",
"RSG",
"STZ",
"KMB",
"EXC",
"CTVA",
"CTAS",
"TEL",
"DVN",
"SYY",
"MSI",
"KMI",
"O",
"TRV",
"MSCI",
"WMB",
"DOW",
"XEL",
"MCHP",
"JCI",
"NUE",
"AFL",
"ENPH",
"A",
"PRU",
"PH",
"PSX",
"GPN",
"AJG",
"ANET",
"TT",
"HLT",
"CARR",
"SBAC",
"SPG",
"HPQ",
"DLTR",
"TDG",
"DLR",
"EA",
"NEM",
"ALL",
"BK",
"CTSH",
"ODFL",
"WELL",
"BF-B",
"TWTR",
"HES",
"WBA",
"ED",
"RMD",
"OTIS",
"KR",
"YUM",
"PEG",
"IDXX",
"WEC",
"ALB",
"VRSK",
"CMI",
"ILMN",
"PCAR",
"DD",
"BIIB",
"AMP",
"PPG",
"DFS",
"FAST",
"GLW",
"ES",
"NDAQ",
"ROST",
"IFF",
"MTD",
"ABC",
"KEYS",
"EBAY",
"CPRT",
"LYB",
"ON",
"AVB",
"TROW",
"FRC",
"BAX",
"APTV",
"EQR",
"AME",
"ROK",
"GWW",
"TSN",
"LVS",
"CBRE",
"AWK",
"OKE",
"DHI",
"EXR",
"ARE",
"WY",
"STT",
"SIVB",
"EFX",
"HRL",
"EIX",
"LEN",
"HAL",
"DTE",
"K",
"FITB",
"IT",
"WST",
"EPAM",
"ANSS",
"LH",
"DRE",
"FTV",
"ZBH",
"CDW",
"AEE",
"MTB",
"URI",
"MPWR",
"ETR",
"MKC",
"FANG",
"VMC",
"PAYC",
"HIG",
"LUV",
"CTRA",
"FE",
"MLM",
"PPL",
"BKR",
"ALGN",
"RJF",
"GPC",
"VRSN",
"CF",
"TSCO",
"VICI",
"DAL",
"LYV",
"CHD",
"RF",
"IR",
"MAA",
"NTRS",
"ULTA",
"STE",
"BR",
"HBAN",
"PFG",
"VTR",
"JBHT",
"WAT",
"PWR",
"CNP",
"MOS",
"CMS",
"FOXA",
"FOX",
"DOV",
"PKI",
"SYF",
"AMCR",
"CAH",
"MOH",
"ESS",
"BBY",
"GRMN",
"MTCH",
"HPE",
"BRO",
"CTLT",
"SWKS",
"TDY",
"MRO",
"XYL",
"STX",
"ZBRA",
"VFC",
"FLT",
"HOLX",
"ROL",
"EXPD",
"KEY",
"TRMB",
"CLX",
"WAB",
"GNRC",
"SEDG",
"DGX",
"IP",
"J",
"EXPE",
"DRI",
"CFG",
"TER",
"CINF",
"TYL",
"AVY",
"MGM",
"FDS",
"NTAP",
"AES",
"COO",
"CAG",
"HWM",
"KMX",
"BIO",
"LKQ",
"EVRG",
"IEX",
"INCY",
"SWK",
"LNT",
"WDC",
"IRM",
"POOL",
"ATO",
"NVR",
"UDR",
"JKHY",
"OMC",
"PEAK",
"AKAM",
"CHRW",
"ETSY",
"CPB",
"TXT",
"DPZ",
"TECH",
"L",
"CPT",
"PTC",
"BEN",
"SJM",
"KIM",
"FMC",
"TTWO",
"NDSN",
"BXP",
"NLOK",
"LDOS",
"HST",
"PKG",
"EMN",
"MAS",
"VTRS",
"ABMD",
"CTXS",
"CE",
"CBOE",
"UAL",
"SBNY",
"CCL",
"SNA",
"TAP",
"AAP",
"QRVO",
"NI",
"TFX",
"IPG",
"LW",
"CRL",
"WRB",
"LUMN",
"PHM",
"REG",
"WRK",
"CMA",
"NWS",
"NWSA",
"HAS",
"CZR",
"RE",
"RCL",
"HSIC",
"DISH",
"FFIV",
"CDAY",
"GL",
"BBWI",
"MKTX",
"NRG",
"WHR",
"NLSN",
"AAL",
"AOS",
"TPR",
"BWA",
"AIZ",
"FBHS",
"DVA",
"JNPR",
"ALLE",
"LNC",
"HII",
"RHI",
"ZION",
"UHS",
"NWL",
"FTNT",
"IVZ",
"PNW",
"DXCM",
"SEE",
"FRT",
"MHK",
"PNR",
"XRAY",
"WYNN",
"OGN",
"RL",
"DXC",
"PENN",
"ALK",
"NCLH",
"VNO",
"PVH"
)
sp_500 = list()
for (stock in files) 
{
  stock <- gsub('.{4}$', '', stock)
  #if(grepl(stock, stocks))
  if(stock %in% stocks)
  {
    sp_500[[length(sp_500)+1]] = stock 
  }
}
```

```{r top10}
top10 = stocks[1:10]
top10
#doesn't work
#top10 |> ggplot(mapping = aes(x = date, y = `Adj close`, color="red"))
# how do I do this?
bottom10 = stocks[473:482]
bottom10
```

```{r}
# use cbind and rbind to combine dataframes


# top 10
aapl_stock <- read_csv("AAPL.csv")
msft_stock <- read_csv("MSFT.csv")
googl_stock <- read_csv("GOOGL.csv")
tsla_stock <- read_csv("TSLA.csv")
unh_stock <- read_csv("UNH.csv")
nvda_stock <- read_csv("NVDA.csv")
jnj_stock <- read_csv("JNJ.csv")
xom_stock <- read_csv("XOM.csv")
jpm_stock <- read_csv("JPM.csv")
wmt_stock <- read_csv("WMT.csv")

top_stocks_combined <- rbind(aapl_stock, msft_stock, googl_stock, tsla_stock, unh_stock, nvda_stock, jnj_stock, xom_stock, jpm_stock, wmt_stock)

#top_stocks_combined["Name"] = rep(c("AAPL"), each = nrow("AAPL.csv"))
#rep(c("A","B","C","D","E"),each=4)

#top_stocks_combined["Name"] = c()
#____________________________________________________________
# experimentation, delete when done
#apple_list <- list()
#apple <- read_csv("AAPL.csv")
#apple_rows <- nrow(apple["Date"])
#for (n in 1:apple_rows)
#{
#  apple_list[[length(apple_list) + 1]] = "AAPL"
#}

#nrow(top_stocks_combined)
#for (i in length(apple_list):nrow(top_stocks_combined))
#{
#  apple_list[[length(apple_list) + 1]] = "filler value"
#}

#____________________________________________________________
for (n in nrow("AAPL.csv"))
{
  top_stocks_combined["Name"] <- top_stocks_combined["Name"][[length(top_stocks_combined["Name"] + 1)]] = n
}

glimpse(top_stocks_combined)


top_10_plot <- top_stocks_combined |> ggplot(data=top_stocks_combined, mapping = aes(x = Date, y = Open)) + geom_point(size=0.0001) + geom_smooth(se=TRUE)# + coord_cartesian(xlim=c(as.Date(1990, origin=“1990-01-01”), as.Date(2023, origin=“2023-01-01”)))
top_10_plot



# bottom 10
uhs_stock <- read_csv("UHS.csv")
nwl_stock <- read_csv("NWL.csv")
ftnt_stock <- read_csv("FTNT.csv")
ivz_stock <- read_csv("IVZ.csv")
pnw_stock <- read_csv("PNW.csv")
dxcm_stock <- read_csv("DXCM.csv")
see_stock <- read_csv("SEE.csv")
frt_stock <- read_csv("FRT.csv")
mhk_stock <- read_csv("MHK.csv")
pnr_stock <- read_csv("PNR.csv")

bottom_stocks_combined <- rbind(uhs_stock, nwl_stock, ftnt_stock, ivz_stock, pnw_stock, dxcm_stock, see_stock, frt_stock, mhk_stock, pnr_stock)

bottom_10_plot <- bottom_stocks_combined |> ggplot(data=bottom_stocks_combined, mapping = aes(x = Date, y = Open)) + geom_point(size=0.4) + geom_smooth(se=TRUE)
bottom_10_plot


```

